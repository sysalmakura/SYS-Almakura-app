// SYS Almakura â€“ AI Chat App (Full Combined Code)
// Version 1.0

import React, { useState, useEffect } from "react";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";

// AI API Configuration (you can connect it to OpenAI, Gemini, or your own backend)
const API_KEY = "YOUR_AI_API_KEY"; // replace with real API key later

export default function SYSAlmakuraApp() {
  const [messages, setMessages] = useState([
    { sender: "ai", text: "Assalamu alaikum! Ni SYS Almakura ne â€” abokinka mai basira. Ina taimaka maka yau?" },
  ]);
  const [input, setInput] = useState("");
  const [speaking, setSpeaking] = useState(false);

  // Voice Input (Speech-to-Text)
  const startVoiceInput = () => {
    const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
    recognition.lang = "auto";
    recognition.start();
    recognition.onresult = (event) => {
      const voiceText = event.results[0][0].transcript;
      setInput(voiceText);
    };
  };

  // Voice Output (Text-to-Speech)
  const speak = (text) => {
    const utterance = new SpeechSynthesisUtterance(text);
    utterance.lang = "auto";
    window.speechSynthesis.speak(utterance);
    setSpeaking(true);
    utterance.onend = () => setSpeaking(false);
  };

  // Send message and get AI reply
  const sendMessage = async () => {
    if (!input.trim()) return;

    const userMessage = { sender: "user", text: input };
    setMessages([...messages, userMessage]);
    setInput("");

    const response = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${API_KEY}`,
      },
      body: JSON.stringify({
        model: "gpt-3.5-turbo",
        messages: [{ role: "user", content: input }],
      }),
    });

    const data = await response.json();
    const aiText = data.choices?.[0]?.message?.content || "Na kasa samun amsa a yanzu.";

    const aiMessage = { sender: "ai", text: aiText };
    setMessages((prev) => [...prev, aiMessage]);
    speak(aiText);
  };

  return (
    <div className="min-h-screen bg-black text-white flex flex-col items-center justify-center p-4">
      <h1 className="text-3xl font-bold mb-4 text-gold">SYS Almakura</h1>

      <div className="w-full max-w-lg bg-gray-900 rounded-2xl p-4 shadow-xl overflow-y-auto h-[70vh]">
        {messages.map((msg, i) => (
          <div key={i} className={`my-2 ${msg.sender === "user" ? "text-right" : "text-left"}`}>
            <div
              className={`inline-block p-3 rounded-2xl ${
                msg.sender === "user" ? "bg-blue-600" : "bg-gray-700"
              }`}
            >
              {msg.text}
            </div>
          </div>
        ))}
      </div>

      <div className="w-full max-w-lg flex gap-2 mt-4">
        <Button onClick={startVoiceInput} className="bg-gray-700 hover:bg-gray-600">
          ğŸ¤
        </Button>
        <Input
          value={input}
          onChange={(e) => setInput(e.target.value)}
          placeholder="Rubuta ko faÉ—i abin da kake so..."
          className="flex-1 bg-gray-800 text-white"
        />
        <Button onClick={sendMessage} className="bg-blue-700 hover:bg-blue-600">
          Aika
        </Button>
      </div>

      <footer className="mt-4 text-gray-500 text-sm">
        Â© 2025 SYS Almakura â€¢ Smart AI for Every Language ğŸŒ
      </footer>
    </div>
  );
}
